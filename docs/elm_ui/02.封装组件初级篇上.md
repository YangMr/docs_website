# 封装组件初级篇（上）

## 2-1 本章概述



## 2-2 搭建 vite 项目并配置路由和 element-plus

### 1. 使用vite创建项目

> vite中文站点: https://cn.vitejs.dev/guide/

- 检测node与npm版本

- 创建项目

```shell
npm create vite@latest 

// 或者

npm init vue@latest
```

- 安装依赖

```shell
npm i
```

- 启动项目

```shell
npm run dev
```

- 修改端口号

```ts
// vite.config.ts
server : {
	port : 8080
}
```

### 2. 安装vue-router与element-plus

- 安装vue路由

```shell
npm i vue-router@next --save
```

- 安装element-plus

```shell
npm i element-plus --save
```

- src目录下创建

  - router文件夹

    - index.ts

    ```ts
    import {createRouter,createWebHistory,RouteRecordRaw} from "vue-router"
    import Home from "../views/Home.vue"
    const routes : RouteRecordRaw[] = [
        {
            path : "/",
            component : Home
        }
    ]
    
    const router = createRouter({
        routes,
        history : createWebHistory()
    })
    
    export default router
    ```

  - views文件夹

    - Home.vue

    ```vue
    <template>
      <div>home</div>
    </template>
    <script lang="ts" setup></script>
    <style lang="scss" scoped></style>
    ```

    

- 注册路由

```ts
// main.ts

import { createApp } from 'vue'
// import './style.css'
import App from './App.vue'
import router from './router'

const app = createApp(App)
app.use(router)
app.mount('#app')

```

- 删除App.vue内容, 使用router-view展示路由组件内容

```vue
// App.vue

<script setup lang="ts"></script>

<template>
  <router-view></router-view>
</template>

<style scoped></style>

```

- 引入element-plus并注册

```ts
// main.ts

import { createApp } from 'vue'
// import './style.css'
import App from './App.vue'
import router from './router'
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'

const app = createApp(App)
app.use(ElementPlus)
app.use(router)
app.mount('#app')
```

- 重置标签默认样式

```vue
// App.vue

<style lang="scss">
* {
  margin: 0;
  padding: 0;
}
</style>
```

- 安装scss插件

```shell
npm i sass sass-loader

或者

 npm install -D sass --registry=https://registry.npmmirror.com
```



## 2-3 全局注册图标

### 1. 安装element图标

```shell
npm install @element-plus/icons-vue
```

### 2. 全局注册图标

```ts
// main.ts

import { createApp } from 'vue'
// import './style.css'
import App from './App.vue'
import router from './router'

// 引入element plus
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'

// 引入element plus icons
import * as ElementPlusIconsVue from '@element-plus/icons-vue'

const app = createApp(App)

// 注册element plus 图标
for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
    app.component(key, component)
}
  
app.use(ElementPlus)
app.use(router)
app.mount('#app')
```

### 3.将图标改造成使用el-icon的方式使用

1. 将传入的字符串中的大写字母前添加短横线，并将结果转换为小写字母。

`utils/index.ts`

```ts


/**
这段代码是一个 JavaScript 函数，名为 toLine。它接受一个字符串参数 value，然后执行以下操作：
    1. 使用正则表达式 /([A-Z])/g 匹配字符串中的大写字母（A-Z）。
    2. 将匹配到的大写字母替换为 "-" 加上该大写字母本身，通过替换字符串的方式在大写字母前添加一个短横线。
    3. 最后，将替换后的字符串转换为小写字母，并将结果作为函数的返回值。
    换句话说，这个函数的作用是将传入的字符串中的大写字母前添加短横线，并将结果转换为小写字母。
 */

// 将驼峰转化为横杠链接
export const toLine = (value : string) => {
    return value.replace(/(A-Z)g/, "-$1").toLocaleLowerCase()
}
```

2. 重新注册element plus图标, 并添加el-icon前缀

```ts
import { createApp } from 'vue'
// import './style.css'
import App from './App.vue'
import router from './router'

// 引入element plus
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'

// 引入element plus icons
import * as ElementPlusIconsVue from '@element-plus/icons-vue'
import { toLine } from './utils'

const app = createApp(App)


// 注册element plus 图标
for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
    app.component(`el-icon-${toLine(key)}`,component)
    // app.component(key, component)
}
  
app.use(ElementPlus)
app.use(router)
app.mount('#app')
```



## 2-4 伸缩菜单-完成伸缩菜单基本功能

## 2-5 伸缩菜单-抽离头部和侧边栏组件并完善伸缩菜单

## 2-6 图标选择器-巧用两次 watch 控制弹框的显示与隐藏

## 2-7 图标选择器-巧用 component 动态组件显示所有的图标

## 2-8 图标选择器-利用命名空间修改 dialog 样式

## 2-9 图标选择器-通过自定义 hooks 函数实现复制功能

## 2-10 省市区选择组件-利用 github 获取到省市区数据

## 2-11 省市区选择组件-巧用 watch 来达到三级联动效果

## 2-12 省市区选择组件-完善省市区联动组件并给父组件分发事件

## 2-13 利用 app.use 特性全局注册组件

## 2-14 扩展一个省市区街道四级联动组件

## 2-15 扩展一个级联选择框的省市区组件

## 2-16 本章总结
